module.exports = {
    initMemory() {
        if (!Memory.creeps) {
            Memory.creeps = {};
        }
        if (!Memory.rooms) {
            Memory.rooms = {};
        }
        if (!Memory.scouting) {
            Memory.scouting = {};
        }
        if (!Memory.scouting.queue) {
            Memory.scouting.queue = [];
        }
        if (!Memory.bunkerStamp) {
            Memory.bunkerStamp = {
                "anchor": {"x": 0, "y": 0},
                "buildings":{
                    "link":[{"x":0,"y":-1}],
                    "spawn":[{"x":-1,"y":1},{"x":1,"y":4},{"x":4,"y":1}],
                    "terminal":[{"x":-1,"y":-1}],
                    "tower":[{"x":-1,"y":0},{"x":0,"y":2},{"x":1,"y":2},{"x":0,"y":3},{"x":2,"y":1},{"x":2,"y":0}],
                    "nuker":[{"x":0,"y":1}],
                    "storage":[{"x":1,"y":1}],
                    "factory":[{"x":1,"y":0}],
                    "powerSpawn":[{"x":1,"y":-1}],
                    "extension":[{"x":0,"y":-2},{"x":1,"y":-2},{"x":-1,"y":-2},{"x":-2,"y":0},{"x":-2,"y":1},{"x":-2,"y":-1},{"x":-1,"y":2},{"x":2,"y":-1},{"x":3,"y":0},{"x":0,"y":-3},{"x":-3,"y":0},{"x":-5,"y":-3},{"x":-4,"y":-3},{"x":-5,"y":-2},{"x":-4,"y":-2},{"x":-3,"y":-2},{"x":-4,"y":-1},{"x":-5,"y":-1},{"x":-5,"y":1},{"x":-4,"y":1},{"x":-5,"y":2},{"x":-4,"y":2},{"x":-3,"y":2},{"x":-4,"y":3},{"x":-5,"y":3},{"x":-5,"y":4},{"x":-4,"y":5},{"x":-3,"y":5},{"x":-2,"y":5},{"x":-1,"y":5},{"x":-1,"y":4},{"x":-2,"y":4},{"x":-3,"y":4},{"x":-2,"y":3},{"x":-3,"y":-5},{"x":-4,"y":-5},{"x":-3,"y":-4},{"x":-2,"y":-3},{"x":-2,"y":-4},{"x":-1,"y":-4},{"x":-1,"y":-5},{"x":1,"y":-5},{"x":1,"y":-4},{"x":2,"y":-4},{"x":2,"y":-3},{"x":3,"y":-4},{"x":3,"y":-5},{"x":4,"y":-5},{"x":5,"y":-4},{"x":5,"y":-3},{"x":5,"y":-2},{"x":5,"y":-1},{"x":4,"y":-1},{"x":4,"y":-2},{"x":4,"y":-3},{"x":3,"y":-2},{"x":1,"y":5},{"x":2,"y":5},{"x":5,"y":1},{"x":5,"y":2}],
                    "road":[{"x":-4,"y":0},{"x":-3,"y":1},{"x":-2,"y":2},{"x":-1,"y":3},{"x":0,"y":4},{"x":1,"y":3},{"x":2,"y":2},{"x":3,"y":1},{"x":4,"y":0},{"x":3,"y":-1},{"x":2,"y":-2},{"x":1,"y":-3},{"x":0,"y":-4},{"x":-1,"y":-3},{"x":-2,"y":-2},{"x":-3,"y":-1},{"x":3,"y":3},{"x":4,"y":4},{"x":5,"y":5},{"x":6,"y":6},{"x":-3,"y":3},{"x":-4,"y":4},{"x":-5,"y":5},{"x":-6,"y":6},{"x":3,"y":-3},{"x":4,"y":-4},{"x":5,"y":-5},{"x":6,"y":-6},{"x":-3,"y":-3},{"x":-4,"y":-4},{"x":-5,"y":-5},{"x":-6,"y":-6},{"x":0,"y":-5},{"x":0,"y":-6},{"x":-4,"y":-6},{"x":-3,"y":-6},{"x":-2,"y":-6},{"x":1,"y":-6},{"x":-1,"y":-6},{"x":2,"y":-6},{"x":3,"y":-6},{"x":4,"y":-6},{"x":6,"y":-3},{"x":6,"y":-4},{"x":6,"y":-2},{"x":6,"y":-1},{"x":6,"y":0},{"x":6,"y":1},{"x":6,"y":2},{"x":6,"y":3},{"x":6,"y":4},{"x":4,"y":6},{"x":3,"y":6},{"x":2,"y":6},{"x":1,"y":6},{"x":-1,"y":6},{"x":-2,"y":6},{"x":-3,"y":6},{"x":-4,"y":6},{"x":0,"y":6},{"x":-6,"y":4},{"x":-6,"y":3},{"x":-6,"y":2},{"x":-6,"y":1},{"x":-6,"y":0},{"x":-6,"y":-1},{"x":-6,"y":-2},{"x":-6,"y":-3},{"x":-6,"y":-4},{"x":-5,"y":0},{"x":5,"y":0},{"x":0,"y":5}],
                    "observer":[{"x":-5,"y":-4}],
                    "lab":[{"x":3,"y":2},{"x":4,"y":2},{"x":4,"y":3},{"x":5,"y":3},{"x":5,"y":4},{"x":2,"y":3},{"x":2,"y":4},{"x":3,"y":4},{"x":3,"y":5},{"x":4,"y":5}],
                    "rampart":[{"x":-6,"y":-6},{"x":-5,"y":-6},{"x":-4,"y":-6},{"x":-3,"y":-6},{"x":-2,"y":-6},{"x":-1,"y":-6},{"x":0,"y":-6},{"x":1,"y":-6},{"x":2,"y":-6},{"x":3,"y":-6},{"x":4,"y":-6},{"x":5,"y":-6},{"x":6,"y":-6},{"x":6,"y":-5},{"x":6,"y":-4},{"x":6,"y":-3},{"x":6,"y":-2},{"x":6,"y":-1},{"x":6,"y":0},{"x":6,"y":1},{"x":6,"y":2},{"x":6,"y":3},{"x":6,"y":4},{"x":6,"y":5},{"x":6,"y":6},{"x":5,"y":6},{"x":4,"y":6},{"x":3,"y":6},{"x":2,"y":6},{"x":1,"y":6},{"x":0,"y":6},{"x":-1,"y":6},{"x":-2,"y":6},{"x":-3,"y":6},{"x":-4,"y":6},{"x":-5,"y":6},{"x":-6,"y":6},{"x":-6,"y":5},{"x":-6,"y":4},{"x":-6,"y":3},{"x":-6,"y":2},{"x":-6,"y":1},{"x":-6,"y":0},{"x":-6,"y":-1},{"x":-6,"y":-2},{"x":-6,"y":-3},{"x":-6,"y":-4},{"x":-6,"y":-5},{"x":1,"y":4},{"x":2,"y":4},{"x":3,"y":4},{"x":3,"y":5},{"x":4,"y":5},{"x":4,"y":1},{"x":4,"y":2},{"x":4,"y":3},{"x":5,"y":3},{"x":5,"y":4}]
                }
            };
        }
        if (!Memory.bunkerCore) {
            Memory.bunkerCore = {
                "anchor": {"x": 0, "y": 0},
                "buildings":{
                    "spawn":[{"x":0,"y":-1}],
                    "rampart":[{"x":-1,"y":-1},{"x":0,"y":-1},{"x":1,"y":-1},{"x":1,"y":0},{"x":1,"y":1},{"x":0,"y":1},{"x":-1,"y":1},{"x":-1,"y":0},{"x":-1,"y":2},{"x":0,"y":2},{"x":1,"y":2},{"x":1,"y":3},{"x":0,"y":3},{"x":-1,"y":3},{"x":-2,"y":3},{"x":-2,"y":2},{"x":0,"y":0}],"storage":[{"x":-1,"y":0}],
                    "terminal":[{"x":1,"y":0}],
                    "link":[{"x":-1,"y":-1}],
                    "lab":[{"x":-1,"y":1},{"x":0,"y":1},{"x":-1,"y":2},{"x":0,"y":2},{"x":-2,"y":2},{"x":1,"y":2},{"x":1,"y":3},{"x":0,"y":3},{"x":-1,"y":3},{"x":-2,"y":3}],
                    "nuker":[{"x":1,"y":-1}],
                    "factory":[{"x":1,"y":1}],
                    "road":[{"x":0,"y":-2},{"x":-1,"y":-2},{"x":-2,"y":-1},{"x":-2,"y":1},{"x":-2,"y":0},{"x":-3,"y":2},{"x":-3,"y":3},{"x":-2,"y":4},{"x":-1,"y":4},{"x":0,"y":4},{"x":1,"y":4},{"x":2,"y":3},{"x":2,"y":2},{"x":2,"y":1},{"x":2,"y":0},{"x":2,"y":-1},{"x":1,"y":-2}]
                }
            };
        }
    },
    cleanCreepsMemory() {
        for (const name in Memory.creeps) {
            if (!Game.creeps[name]) {
                delete Memory.creeps[name];
            }
        }
        if (Memory.rooms) {
            for (const roomName in Memory.rooms) {
                const roomMemory = Memory.rooms[roomName];
                if (roomMemory.sources) {
                    for (const sourceId in roomMemory.sources) {
                        const sourceData = roomMemory.sources[sourceId];
                        if (sourceData.reservations) {
                            sourceData.reservations = sourceData.reservations.filter(creepName => Game.creeps[creepName]);
                        }
                    }
                }
            }
        }
    }
};
